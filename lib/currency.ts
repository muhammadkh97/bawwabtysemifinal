// Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù„Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
export const CURRENCIES = {
  ILS: { symbol: 'â‚ª', name: 'Ø´ÙŠÙƒÙ„ ÙÙ„Ø³Ø·ÙŠÙ†ÙŠ', code: 'ILS', flag: 'ğŸ‡µğŸ‡¸', rate: 1 },
  JOD: { symbol: 'Ø¯.Ø£', name: 'Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ', code: 'JOD', flag: 'ğŸ‡¯ğŸ‡´', rate: 0.19 },
  SAR: { symbol: 'Ø±.Ø³', name: 'Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ', code: 'SAR', flag: 'ğŸ‡¸ğŸ‡¦', rate: 1.36 },
  AED: { symbol: 'Ø¯.Ø¥', name: 'Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ', code: 'AED', flag: 'ğŸ‡¦ğŸ‡ª', rate: 1.0 },
  EGP: { symbol: 'Ø¬.Ù…', name: 'Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ', code: 'EGP', flag: 'ğŸ‡ªğŸ‡¬', rate: 8.5 },
  KWD: { symbol: 'Ø¯.Ùƒ', name: 'Ø¯ÙŠÙ†Ø§Ø± ÙƒÙˆÙŠØªÙŠ', code: 'KWD', flag: 'ğŸ‡°ğŸ‡¼', rate: 0.083 },
  QAR: { symbol: 'Ø±.Ù‚', name: 'Ø±ÙŠØ§Ù„ Ù‚Ø·Ø±ÙŠ', code: 'QAR', flag: 'ğŸ‡¶ğŸ‡¦', rate: 0.99 },
  OMR: { symbol: 'Ø±.Ø¹', name: 'Ø±ÙŠØ§Ù„ Ø¹Ù…Ø§Ù†ÙŠ', code: 'OMR', flag: 'ğŸ‡´ğŸ‡²', rate: 0.10 },
  BHD: { symbol: 'Ø¯.Ø¨', name: 'Ø¯ÙŠÙ†Ø§Ø± Ø¨Ø­Ø±ÙŠÙ†ÙŠ', code: 'BHD', flag: 'ğŸ‡§ğŸ‡­', rate: 0.10 },
  LBP: { symbol: 'Ù„.Ù„', name: 'Ù„ÙŠØ±Ø© Ù„Ø¨Ù†Ø§Ù†ÙŠØ©', code: 'LBP', flag: 'ğŸ‡±ğŸ‡§', rate: 4100 },
  SYP: { symbol: 'Ù„.Ø³', name: 'Ù„ÙŠØ±Ø© Ø³ÙˆØ±ÙŠØ©', code: 'SYP', flag: 'ğŸ‡¸ğŸ‡¾', rate: 6850 },
  IQD: { symbol: 'Ø¯.Ø¹', name: 'Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ', code: 'IQD', flag: 'ğŸ‡®ğŸ‡¶', rate: 356 },
  YER: { symbol: 'Ø±.ÙŠ', name: 'Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ', code: 'YER', flag: 'ğŸ‡¾ğŸ‡ª', rate: 68 },
  TND: { symbol: 'Ø¯.Øª', name: 'Ø¯ÙŠÙ†Ø§Ø± ØªÙˆÙ†Ø³ÙŠ', code: 'TND', flag: 'ğŸ‡¹ğŸ‡³', rate: 0.84 },
  DZD: { symbol: 'Ø¯.Ø¬', name: 'Ø¯ÙŠÙ†Ø§Ø± Ø¬Ø²Ø§Ø¦Ø±ÙŠ', code: 'DZD', flag: 'ğŸ‡©ğŸ‡¿', rate: 36 },
  MAD: { symbol: 'Ø¯.Ù…', name: 'Ø¯Ø±Ù‡Ù… Ù…ØºØ±Ø¨ÙŠ', code: 'MAD', flag: 'ğŸ‡²ğŸ‡¦', rate: 2.7 },
  LYD: { symbol: 'Ø¯.Ù„', name: 'Ø¯ÙŠÙ†Ø§Ø± Ù„ÙŠØ¨ÙŠ', code: 'LYD', flag: 'ğŸ‡±ğŸ‡¾', rate: 1.3 },
  SDG: { symbol: 'Ø¬.Ø³', name: 'Ø¬Ù†ÙŠÙ‡ Ø³ÙˆØ¯Ø§Ù†ÙŠ', code: 'SDG', flag: 'ğŸ‡¸ğŸ‡©', rate: 164 },
  MRU: { symbol: 'Ø£.Ù…', name: 'Ø£ÙˆÙ‚ÙŠØ© Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ©', code: 'MRU', flag: 'ğŸ‡²ğŸ‡·', rate: 10.2 },
  USD: { symbol: '$', name: 'Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ', code: 'USD', flag: 'ğŸ‡ºğŸ‡¸', rate: 0.27 },
  EUR: { symbol: 'â‚¬', name: 'ÙŠÙˆØ±Ùˆ', code: 'EUR', flag: 'ğŸ‡ªğŸ‡º', rate: 0.25 },
};

export type CurrencyCode = keyof typeof CURRENCIES;

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
export function getSavedCurrency(): CurrencyCode {
  if (typeof window === 'undefined') return 'ILS';
  
  const saved = localStorage.getItem('selectedCurrency');
  return (saved as CurrencyCode) || 'ILS';
}

// Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
export function saveCurrency(code: CurrencyCode) {
  if (typeof window === 'undefined') return;
  
  localStorage.setItem('selectedCurrency', code);
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  window.location.reload();
}

// ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³Ø¹Ø± Ù…Ù† Ø§Ù„Ø´ÙŠÙƒÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
export function convertPrice(priceInILS: number, toCurrency?: CurrencyCode): number {
  const currency = toCurrency || getSavedCurrency();
  const rate = CURRENCIES[currency].rate;
  return Math.round(priceInILS * rate * 100) / 100;
}

// ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø³Ø¹Ø± Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¹Ù…Ù„Ø©
export function formatPrice(priceInILS: number, toCurrency?: CurrencyCode): string {
  const currency = toCurrency || getSavedCurrency();
  const converted = convertPrice(priceInILS, currency);
  const symbol = CURRENCIES[currency].symbol;
  
  return `${converted.toFixed(2)} ${symbol}`;
}

// Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
export function getCurrentCurrency() {
  const code = getSavedCurrency();
  return CURRENCIES[code];
}
