# ๐ง ุดุฑุญ ุฎุทุฃ ENUM ุจุณูููุฉ

## ุงูุฎุทุฃ ุงูุฐู ุญุตู

```
ERROR: 55P04: unsafe use of new value "restaurant"
HINT: New enum values must be committed before they can be used.
```

## ููุงุฐุง ุญุฏุซุ

### ุงูููุฑุฉ ุงูุจุณูุทุฉ:

PostgreSQL ูุฏููุง ูุงุฆูุฉ ุจุงูุฃุฏูุงุฑ ุงูููุฌูุฏุฉ:
```
[customer, vendor, driver, admin]
```

ุนูุฏูุง ุชุฑูุฏ ุฅุถุงูุฉ ุฏูุฑ ุฌุฏูุฏ (restaurant)ุ PostgreSQL:
1. โ ูุถููู ุฅูู ุงููุงุฆูุฉ
2. โณ ููุชุธุฑ confirmation ูู ุงูุจุฑูุงูุฌ
3. โ ูู ุญุงููุช ุงุณุชุฎุฏุงู ุงูุฏูุฑ ุงูุฌุฏูุฏ ูุจู confirmation โ ุฎุทุฃ!

---

## ุงููุดููุฉ

ูู ููู ูุงุญุฏ ูุชุจูุง:
```sql
-- ุฅุถุงูุฉ ุงูุฏูุฑ
ALTER TYPE user_role ADD VALUE 'restaurant';

-- ุงุณุชุฎุฏุงู ุงูุฏูุฑ ูุจุงุดุฑุฉ (โ ุฎุทุฃ!)
CREATE POLICY "..." USING (...role = 'restaurant'...);
```

โ PostgreSQL ุฑูุน ุฎุทุฃ ูุฃููุง ุงุณุชุฎุฏููุง ุงูุฏูุฑ ุงูุฌุฏูุฏ ูุจู confirmation

---

## ุงูุญู

**ูุตู ุฅูู ุฃุฌุฒุงุก ูููุตูุฉ:**

### PART 1:
```sql
-- ุฅุถุงูุฉ ููุท (ุจุฏูู ุงุณุชุฎุฏุงู)
ALTER TYPE user_role ADD VALUE 'restaurant';
-- โ DONE
```

ุซู ูุชููู ููุชุฑู PostgreSQL ูุคูุฏ (commit).

### PART 2:
```sql
-- ุงูุขู ูููููุง ุงูุงุณุชุฎุฏุงู
CREATE POLICY "..." USING (...role = 'restaurant'...);
-- โ ุงูุขู ูุนูู!
```

---

## ุงูุชุดุจูู

### ูุจู:
```
ุฃูุช ุชุญุงูู ุงููุชุงุจุฉ ูู ูุชุงุจ:
  โ ุชุถูู ุตูุญุฉ ุฌุฏูุฏุฉ
  โ ุชูุชุจ ูููุง ูุจุงุดุฑุฉ
  โ ูุจู ุฃู ุชูุตููุง ูู ุงููุชุงุจ
  โ ุฎุทุฃ!
```

### ุจุนุฏ:
```
โ ุชุถูู ุตูุญุฉ ุฌุฏูุฏุฉ
โ ุชูุตููุง ูู ุงููุชุงุจ (COMMIT)
โ ุซู ุชูุชุจ ูููุง
โ ูุนูู!
```

---

## ุงูุญู ุงูุนููู

### ุงูุทุฑููุฉ ุงูุฎุงุทุฆุฉ:
```sql
-- ูู ููู ูุงุญุฏ (โ ูุง ุชูุนู ูุฐุง)
ALTER TYPE user_role ADD VALUE 'restaurant';
CREATE POLICY ... USING (role = 'restaurant'); -- โ ุฎุทุฃ!
```

### ุงูุทุฑููุฉ ุงูุตุญูุญุฉ:
```sql
-- PART 1 (ูู transaction ุฃูู)
ALTER TYPE user_role ADD VALUE 'restaurant';
-- โ ุงูุชุธุฑ ุญุชู ููุชูู

-- PART 2 (ูู transaction ุซุงูู)
CREATE POLICY ... USING (role = 'restaurant');
-- โ ุงูุขู ูุนูู!
```

---

## ููุงุฐุง Supabaseุ

Supabase ูุดุบู ูู SQL ูู transaction ูููุตู ุจุดูู ุงูุชุฑุงุถู.

ููู ุฅุฐุง ูุงู ุงูุณูุฑูุจุช ูุญุชูู ุนูู ุนุฏุฉ statements:
- ูุฏ ูุญุงูู ุชุดุบูููู ูุนุงู
- ููุญุตู ุงูุฎุทุฃ

---

## ุงูุญู ููุงุฆู

ุงุณุชุฎุฏู ุงููููุงุช ุงูุซูุงุซุฉ:

| ุงูููู | ุงูุฏูุฑ |
|------|-------|
| PART1.sql | ุฅุถุงูุฉ ENUM ููุท |
| PART2.sql | ุงุณุชุฎุฏุงู ENUM |
| PART3.sql | ุงูุชุญูู |

---

## ูู ูููุช ูุฐุง

ุฃูุช ุงูุขู ุชููู PostgreSQL ENUM Transactions! ๐

---

**ุงูุญู ุจุณูุท: ูุตูู ูุงูุชุธุฑ! โ**
