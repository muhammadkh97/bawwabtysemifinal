# ๐๏ธ ุฅูุดุงุก ุฌุฏูู ุงูููุจููุงุช

## ๐ ุงููุดููุฉ
```
Error: Could not find the table 'public.coupons' in the schema cache
```

## โ ุงูุญู

### ุงูุฎุทูุฉ 1: ุชุทุจูู Migration
1. ุงูุชุญ [Supabase SQL Editor](https://supabase.com/dashboard)
2. ุงูุณุฎ ูุญุชูู ุงูููู:
   ```
   supabase/migrations/20260104_create_coupons_table.sql
   ```
3. ููุฐ ุงูููุฏ

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงููุชูุฌุฉ
ุจุนุฏ ุงูุชูููุฐ ูุฌุจ ุฃู ุชุฑู:
```
Coupons table created successfully
Coupon usage table created successfully
```

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงูุญู
ุฌุฑุจ ุฅูุดุงุก ููุจูู ุฌุฏูุฏ:
1. ุงุฐูุจ ุฅูู `/dashboard/vendor/promotions`
2. ุงุถุบุท ุนูู "ุฅุถุงูุฉ ููุจูู ุฌุฏูุฏ"
3. ููุฃ ุงูุจูุงูุงุช ูุงุถุบุท ุญูุธ
4. โ ูุฌุจ ุฃู ููุฌุญ ุงูุขู!

---

## ๐ ูุง ุชู ุฅูุดุงุคู

### 1๏ธโฃ ุฌุฏูู `coupons`
```sql
- id: ูุนุฑู ูุฑูุฏ
- vendor_id: ูุนุฑู ุงููุชุฌุฑ
- name: ุงุณู ุงูููุจูู
- code: ุฑูุฒ ุงูููุจูู (ูุฑูุฏ)
- description: ูุตู ุงูููุจูู
- discount_type: ููุน ุงูุฎุตู (percentage/fixed)
- discount_value: ูููุฉ ุงูุฎุตู
- min_purchase: ุงูุญุฏ ุงูุฃุฏูู ููุดุฑุงุก
- max_discount: ุฃูุตู ุฎุตู
- usage_limit: ุญุฏ ุงูุงุณุชุฎุฏุงู
- used_count: ุนุฏุฏ ุงููุฑุงุช ุงููุณุชุฎุฏูุฉ
- start_date: ุชุงุฑูุฎ ุงูุจุฏุก
- end_date: ุชุงุฑูุฎ ุงูุงูุชูุงุก
- is_active: ุญุงูุฉ ุงูุชูุนูู
```

### 2๏ธโฃ ุฌุฏูู `coupon_usage`
ูุชุชุจุน ุงุณุชุฎุฏุงู ุงูููุจููุงุช:
```sql
- coupon_id: ูุนุฑู ุงูููุจูู
- order_id: ูุนุฑู ุงูุทูุจ
- user_id: ูุนุฑู ุงููุณุชุฎุฏู
- discount_amount: ูููุฉ ุงูุฎุตู
- used_at: ููุช ุงูุงุณุชุฎุฏุงู
```

### 3๏ธโฃ RLS Policies
โ ุงูููุจููุงุช ุงููุดุทุฉ ูุงูุณุงุฑูุฉ ุชุธูุฑ ููุฌููุน
โ ุงูุจุงุฆุน ูุฑู ููุจููุงุชู ููุท
โ ุงูุงุฏูู ูุฑู ุฌููุน ุงูููุจููุงุช
โ ุงูุจุงุฆุน ููููู ุฅุฏุฑุงุฌ ูุชุนุฏูู ูุญุฐู ููุจููุงุชู ููุท

### 4๏ธโฃ Trigger ู Function
โ ุชุญุฏูุซ ุชููุงุฆู ูุนุฏุฏ ูุฑุงุช ุงุณุชุฎุฏุงู ุงูููุจูู

### 5๏ธโฃ Indexes
โ ููุงุฑุณ ููุฃุฏุงุก ุงูุณุฑูุนุฉ

---

## ๐งช ุงุฎุชุจุงุฑ ุณุฑูุน

```sql
-- ุชุญูู ูู ุฃู ุงูุฌุฏุงูู ููุฌูุฏุฉ
SELECT table_name FROM information_schema.tables 
WHERE table_name IN ('coupons', 'coupon_usage');

-- ุนุฑุถ ุนุฏุฏ ุงูููุจููุงุช
SELECT COUNT(*) FROM coupons;

-- ุนุฑุถ ุงูู RLS policies
SELECT policyname FROM pg_policies 
WHERE tablename = 'coupons';
```

---

## ๐ ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ

1. **ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ:** Ctrl+Shift+Delete (ุงูุณุญ ุงูู cache)
2. **ุชุญูู ูู ุชุทุจูู Migration:** ุงูุฐูุงุจ ุฅูู Supabase Dashboard โ Migrations
3. **ุฌุฑุจ ุฅุนุงุฏุฉ ุชุญููู schema:** ุงูุชุธุฑ 30 ุซุงููุฉ ุซู ุฃุนุฏ ุชุญููู ุงููุชุตูุญ

---

## ๐ ุงููููุงุช ุฐุงุช ุงูุตูุฉ
- [app/dashboard/vendor/promotions/page.tsx](../../app/dashboard/vendor/promotions/page.tsx)
- [supabase/migrations](../migrations/)
